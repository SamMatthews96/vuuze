<!DOCTYPE html>
<html lang="en">

<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <link rel="stylesheet" href="style.css">
  <title>Vite App</title>
</head>

<body>
  <!-- <div id="container"> -->
  <canvas id="app"></canvas>
  <!-- </div> -->
</body>

<script type='module'>
  import Intreface from './main.js'
  const { Retool, Chart } = Intreface;
  let instance

  const model = {
    data: {
      Income: {
        //color: 'rgba(255, 99, 132, 0.2)',
        //tick: '${{value}}',
        dataset: { "June": 100, "July": 200, "August": 300.5, "September": 251.42 }
      },
      Outgoing: {
        //tick: 'GBP {{value}}',
        dataset: { "June": 32, "July": 32.4, "August": 30.5, "September": 821.43 }
      },
      Plan: {
        dataset: { "June": 332, "July": 312.4, "August": 330.5, "September": 321.43 }
      }
    },
    parameters: {
      //stacked: true,
      title: 'Hello World!'
    },
    scale: {
      width: 600,
      height: 400
    }
  }


  Retool.setContext({
    subscribe: fn => fn(model)
  })

  Retool.onCreate((model) => {
    console.log(model)
    instance = Chart.Bar(model)
    instance.resize(model.scale.width, model.scale.height)
    instance.update()
  });
  Retool.onUpdate(model => {
    console.log('updated')
    instance.update();
  });
  Retool.listen();

  window.onkeypress = function (event) {
    if (event.keyCode == 32) {
      instance.resize(instance.width + 10, instance.height + 10)
    }
  }

</script>

</html>